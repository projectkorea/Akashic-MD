# async await

-   Promise Chaining을 간편하게, 동기식으로, 작성할 수 있도록 도와준다.
-   It's easy, clear style of using promise
    -   It's `syntatic sugar` : 편리한 사용을 위한 그럴싸한 문법

## 1. async

-   오래 걸리는 일은 비동기로 처리할 수 있게 바꿔준다.
-   **함수 앞에 async 키워드**를 붙이면, 함수 안에 있는 **코드 블럭들이 promise로 바뀐다.**

```js
async function fetchUser() {
    // do network request in 10secs
    return 'junha';
}
const user = fetchUser();
console.log(user);
```

## 2. await

**예시) async/await을 쓰지 않고 promise then만 쓰는 경우**

```js
function delay(ms) {
    return new Promise((resolve) => setTimeout(resolve, ms));
}

function getApple() {
    return delay(2000).then(() => '🍎');
}

function getBanana() {
    return delay(1000).then(() => '🍌');
}

function pickFruits() {
    return getApple().then((apple) => {
        return getBanana().then((banana) => `${apple} + ${banana}`);
    });
}

pickFruits().then(console.log);
//pickFruits().then((value)=> console.log(value);
```

**예시) async/await을 사용하여 동기적으로 표현한 경우**

```js
async function pickFruits() {
    const apple = await getApple(); // 2초 소모
    const banana = await getBanana(); // 1초 소모
    return `${apple}+${banana}`; // 총 3초 소모
}

pickFruits().then(console.log);
```

-   promise보다 간결하고 직관적으로 표현할 수 있다.

```js
async function effPickFruits() {
    const applePromise = getApple(); // execute immediately
    const bananaPromise = getBanana(); // execute immediately
    const apple = await applePromise; // 위에서 부터 실행되었기 때문에 2초 이하 소모
    const banana = await bananaPromise; // applePromise를 기다릴 때 이미 리턴 되어있기 때문에 바로 넘어감
    return `${apple}+${banana}`; // 총 2초 소모
}
effPickFruits().then(console.log);
```

-   프로미스를 병렬적으로 처리하는 경우, `Promise.all()`을 사용하자

## 3. useful promise

-   promise 배열을 전달하게 되면, 모든 promise들이 병렬적으로 받아줄 때 까지 받아준다.

```js
function pickAllFruites() {
    return Promise.all([getApple(), getBanana()]).then((fruits) =>
        fruits.join('+')
    );
}
pickAllFruits().then(console.log);
```

```js
function pickOnlyOne() {
    return Promise.race([getApple(), getBanana()]);
}
pickOnlyOne().then(console.log);
```

-   `Promise.race()`: 배열에서 가장 먼저 return하는 값으로 전달한다.
