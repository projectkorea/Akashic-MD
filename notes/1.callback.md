# Callback

- 자바스크립트는 **동기**적 언어다.

### 1. 동기 VS 비동기

- 동: 한가지, 함께
- 기: 기다리다, 약속하다
- 뭐를?: **요청**과 **응답**을! 또는 **실행**과 **완료**를!

#### 동기(Synchronous)

- **요청** 하면 **응답**이 나올 때 까지 **함께 기다린다.**
- 호이스팅 후에 정해진 순서에 맞게 코드블럭을 실행한다.
- 결과가 나올 때 까지 기다려야 한다.

#### 비동기(Asynchronous)

- 요청 하면 **응답 여부와 무관하게**, 바로 다음 코드로 넘어간다.
- 네트워크 통신, 오래 걸리는 작업, 일정 시간 뒤에 동작해야 하는 작업 등에서 사용한다.
- 단일 스레드 기반의 자바스크립트 엔진이 **비동기 작업**이 가능한 이유는 **브라우저 런타임**에서 DOM 조작, AJAX와 같은 비동기 처리를 위한 **web APIs를 제공**하기 때문이다. 

### 2. 동기 코드 VS 비동기 코드

```js
setInterval(() => {
    blink.style.background = blink.style.background === 'red' ? 'blue' : 'red';
  }, 500);

syncButton.addEventListener('click', () => {
    Counter.incrementSync();
    result.innerHTML = Counter.getCount();
  });

asyncButton.addEventListener('click', () => {
    Counter.incrementAsync(() => {
      result.innerHTML = Counter.getCount();
    });
  });
```

```js
const Counter = {
  count: 0,
  getCount: function () {
    return this.count;
  },

  resetCount: function () {
    this.count = 0;
  },

  incrementSync: function () {
    let start = Date.now();
    let end = Date.now();
    while (end - start <= 3000) {
      end = Date.now();
    } // 동기 코드: 3초가 끝나기전에 다른 코드들은 작동하지 않는다.
    this.count++;
  },

  incrementAsync: function (callback) {
    setTimeout(() => {
      this.count++;
      callback();
    }, 3000); // 비동기 코드: 3초가 지나면 카운트가 올라가는 코드는 setTimeout Web Api로 넘어가기 때문에 다른 코드들이 작동할 수 있다.
  },
};
```

#### 퀴즈

- 출력 순서는?

```js
let i = 1;

console.log("A:", ++i)
setTimeout(()=>console.log("B:",++i),0)
console.log("C:", i++)
```

- `A: 2`
- `C: 2`
- `B: 4`


- 비동기 코드는 무조건 큐로 따로 빠지며, 콜스택이 비었을 때 실행된다.
- 자바스크립트는 대부분의 코드는 동기적으로 실행되기 때문에 `for` 반복문 연산량이 아주 많을 때, 다음 코드 진행 이 오래걸린다.
- 자바스크립트로는 무거운 연산을 실행시키지 않도록 하자.


#### 살펴 볼 코드

```js
Counter.incrementSync();
result.innerHTML = Counter.getCount();
```
- `Counter.incrementSync();`코드는 `while`문으로 구성된 **동기적 타이머 코드**다.
- 따라서 `Counter.incrementSync();`코드가 끝나면 `result.innerHTML = Counter.getCount();`코드가 실행된다.

```js
Counter.incrementAsync(() => {
      result.innerHTML = Counter.getCount();
  });
```
- `Counter.incrementAsync();`코드는 `setTimeout`함수로 구성된 **비동기적 타이머 코드**다.
- 따라서 동기 타이머 코드와 다르게 `result.innerHTML = Counter.getCount();`
